# Backlog Synthesizer - Environment Variables
# Multi-Agent AI System for Backlog Synthesis

# ============================================================================
# AI Model Configuration
# ============================================================================
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# OpenAI (for embeddings)
# OPENAI_API_KEY=your_openai_key_here

# ============================================================================
# JIRA Configuration (via Atlassian MCP)
# ============================================================================
JIRA_URL=https://brandonblack.atlassian.net
JIRA_EMAIL=bmblack@gmail.com
JIRA_API_TOKEN=your_jira_api_token_here
JIRA_PROJECT_KEY=BS

# JIRA Custom Field Mapping
# Found via jira_search_fields MCP tool
# Story Points: "Story point estimate" field
# Epic Link: "Epic Link" field (older JIRA) or use "parent" (newer JIRA)
JIRA_STORY_POINTS_FIELD=customfield_10016
JIRA_EPIC_LINK_FIELD=customfield_10014

# JIRA Integration Settings
# Set to false to actually create issues (use with caution!)
JIRA_DRY_RUN=true

# ============================================================================
# Confluence Configuration (via Atlassian MCP)
# ============================================================================
CONFLUENCE_URL=https://brandonblack.atlassian.net/wiki
CONFLUENCE_EMAIL=bmblack@gmail.com
CONFLUENCE_API_TOKEN=your_jira_api_token_here
CONFLUENCE_SPACE_KEY=ARCH

# ============================================================================
# GitHub Configuration
# ============================================================================
GITHUB_TOKEN=your_github_token_here
GITHUB_OWNER=bmblack
GITHUB_REPO=backlog-synthesizer

# ============================================================================
# Vector Database Configuration
# ============================================================================
# ChromaDB settings
CHROMA_HOST=localhost
CHROMA_PORT=8000
CHROMA_PERSIST_DIRECTORY=./data/chroma

# ============================================================================
# Redis Configuration (for state management and caching)
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=redis://localhost:6379/0

# ============================================================================
# LangGraph Checkpoint Configuration
# ============================================================================
CHECKPOINT_DB_PATH=./data/checkpoints.db

# ============================================================================
# Application Configuration
# ============================================================================
ENVIRONMENT=development
LOG_LEVEL=INFO
DEBUG=true

# ============================================================================
# Model Selection
# ============================================================================
# Primary LLM for complex reasoning tasks (Requirement Extraction)
# Use Sonnet 4.5 for tasks requiring nuanced understanding
REASONING_MODEL=claude-sonnet-4-5-20250929

# Story Generation Model (structured output, less complex)
# Use Haiku for cost optimization on template-driven tasks
STORY_GENERATION_MODEL=claude-3-haiku-20240307

# Default model (fallback)
DEFAULT_LLM_MODEL=claude-sonnet-4-5-20250929
DEFAULT_LLM_TEMPERATURE=0.5
DEFAULT_LLM_MAX_TOKENS=4000
DEFAULT_LLM_TIMEOUT=300

# LLM-as-Judge for evaluation (needs strong reasoning)
JUDGE_LLM_MODEL=claude-sonnet-4-5-20250929
JUDGE_LLM_TEMPERATURE=0.3

# Embedding model
EMBEDDING_MODEL=text-embedding-3-large
EMBEDDING_DIMENSION=3072

# ============================================================================
# Agent Configuration
# ============================================================================
# Gap detection threshold (semantic similarity)
GAP_DETECTION_THRESHOLD=0.7
GAP_DETECTION_BORDERLINE_MIN=0.6
GAP_DETECTION_BORDERLINE_MAX=0.8

# Conflict detection
CONFLICT_DETECTION_ENABLED=true
KEYWORD_CONFLICT_DETECTION_ENABLED=true
LLM_CONFLICT_DETECTION_ENABLED=true

# Story generation
MIN_ACCEPTANCE_CRITERIA=3
MAX_ACCEPTANCE_CRITERIA=5
MIN_INVEST_SCORE=6.0

# Retry configuration
MAX_RETRIES=3
RETRY_DELAY_SECONDS=2

# ============================================================================
# Workflow Configuration
# ============================================================================
# Document processing
MAX_CHUNK_SIZE=512
CHUNK_OVERLAP=50
MAX_CONCURRENT_CHUNKS=5

# Quality thresholds
MIN_STORY_QUALITY_SCORE=7.0
AUTO_APPROVE_QUALITY_THRESHOLD=9.0

# ============================================================================
# Evaluation Configuration
# ============================================================================
GOLDEN_DATASET_PATH=./tests/golden_dataset
EVALUATION_COMPLETENESS_TARGET=0.90
EVALUATION_GAP_F1_TARGET=0.85
EVALUATION_CONFLICT_F1_TARGET=0.85
EVALUATION_QUALITY_TARGET=8.0

# ============================================================================
# API Configuration (FastAPI server)
# ============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# ============================================================================
# Monitoring & Observability
# ============================================================================
# Enable monitoring
MONITORING_ENABLED=true

# Prometheus metrics
METRICS_ENABLED=true
METRICS_PORT=9090

# ============================================================================
# Security
# ============================================================================
# API key for web dashboard (optional)
API_KEY=

# CORS settings
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ============================================================================
# Optional: Database Configuration (for future)
# ============================================================================
# POSTGRES_USER=backlog_synth
# POSTGRES_PASSWORD=
# POSTGRES_DB=backlog_synthesizer
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# DATABASE_URL=postgresql://backlog_synth:password@localhost:5432/backlog_synthesizer
